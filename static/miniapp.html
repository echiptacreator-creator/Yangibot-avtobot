<!DOCTYPE html>
<html lang="uz">
<head>
<meta name="color-scheme" content="light dark">
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Premium tariflar</title>

<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
:root {
  --bg: var(--tg-theme-bg-color, #f5f7fb);
  --card: var(--tg-theme-secondary-bg-color, #ffffff);
  --text: var(--tg-theme-text-color, #0f172a);
  --muted: var(--tg-theme-hint-color, #6b7280);
  --primary: var(--tg-theme-button-color, #4f46e5);
  --primary-text: var(--tg-theme-button-text-color, #ffffff);
  --radius: 18px;
}

* { box-sizing: border-box; }

body {
  margin: 0;
  background: var(--bg);
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI",
    Roboto, Helvetica, Arial, sans-serif;
  color: var(--text);

  transition: background-color 0.25s ease, color 0.25s ease;
}


.container {
  max-width: 420px;
  margin: auto;
  padding: 18px;
}

.hidden { display: none; }

/* ---------- COMMON ---------- */
.card {
  background: var(--card);
  border-radius: var(--radius);
  padding: 20px;
  box-shadow: 0 14px 40px rgba(0,0,0,0.08);
  margin-top: 16px;
}

h1 {
  font-size: 24px;
  margin: 12px 0 6px;
}

p {
  font-size: 14px;
  color: var(--muted);
  line-height: 1.5;
  margin: 0;
}

button {
  font-family: inherit;
}

/* ---------- ICON ---------- */
.icon-circle {
  width: 54px;
  height: 54px;
  border-radius: 50%;
  background: rgba(79,70,229,0.12);
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto 12px;
  color: var(--primary);
}

/* ---------- BADGE ---------- */
.badge {
  display: inline-block;
  font-size: 12px;
  font-weight: 600;
  padding: 4px 10px;
  border-radius: 999px;
  margin-bottom: 6px;
}

.badge-primary {
  background: rgba(79,70,229,0.12);
  color: var(--primary);
}

/* ---------- TARIFF ---------- */
.tariff {
  border: 2px solid transparent;
  border-radius: 16px;
  padding: 16px;
  margin-bottom: 14px;
  cursor: pointer;
  transition: 0.15s ease;
}

.tariff.active {
  border-color: var(--primary);
  box-shadow: 0 10px 28px rgba(79,70,229,0.25);
}

.tariff h3 {
  font-size: 17px;
  margin: 4px 0;
}

.price {
  font-size: 18px;
  font-weight: 700;
  margin-bottom: 4px;
}

.tariff p {
  font-size: 13px;
}

/* ---------- CTA ---------- */
.cta button {
  width: 100%;
  height: 52px;
  border-radius: 16px;
  border: none;
  background: var(--primary);
  color: var(--primary-text);
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
}

/* ---------- PAYMENT ---------- */
.back-btn {
  background: none;
  border: none;
  color: var(--primary);
  font-weight: 600;
  margin-bottom: 12px;
  cursor: pointer;
}

.pay-info {
  font-size: 14px;
  margin-bottom: 14px;
}

.card-number {
  font-size: 18px;
  font-weight: 600;
  letter-spacing: 1px;
  padding: 14px;
  border-radius: 14px;
  background: rgba(79,70,229,0.08);
  text-align: center;
  margin-bottom: 12px;
}

.copy-btn {
  width: 100%;
  height: 46px;
  border-radius: 14px;
  border: 1.5px solid var(--primary);
  background: transparent;
  color: var(--primary);
  font-weight: 600;
  cursor: pointer;
  margin-bottom: 14px;
}

.hint {
  font-size: 13px;
  color: var(--muted);
  text-align: center;
  margin-top: 10px;
}
</style>
</head>

<body>

<div class="container">

<!-- ================= PAGE 1: TARIFFS ================= -->
<div id="page-tariffs">

  <div class="icon-circle">
    <!-- CREDIT CARD SVG -->
    <svg width="26" height="26" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="1.8"
      stroke-linecap="round" stroke-linejoin="round">
      <rect x="2" y="4" width="20" height="16" rx="3"/>
      <line x1="2" y1="10" x2="22" y2="10"/>
    </svg>
  </div>

  <h1 align="center">Premium tariflar</h1>
  <p align="center">
    Avtomatik e‚Äôlon joylash xizmati orqali<br>
    ko‚Äòproq buyurtma va kamroq vaqt sarfi
  </p>

  <div class="card">

    <div class="tariff" onclick="selectTariff(1, 35000)">
      <h3>1 oy</h3>
      <div class="price">35 000 so‚Äòm</div>
      <p>Sinab ko‚Äòrish uchun</p>
    </div>

    <div class="tariff" onclick="selectTariff(3, 90000)">
      <h3>3 oy</h3>
      <div class="price">90 000 so‚Äòm</div>
      <p>1 oy = 30 000 so‚Äòm</p>
    </div>

    <div class="tariff active" onclick="selectTariff(6, 170000)">
      <span class="badge badge-primary">Eng mashhur</span>
      <h3>6 oy</h3>
      <div class="price">170 000 so‚Äòm</div>
      <p>1 oy ‚âà 28 300 so‚Äòm</p>
    </div>

    <div class="tariff" onclick="selectTariff(12, 360000)">
      <h3>12 oy</h3>
      <div class="price">360 000 so‚Äòm</div>
      <p>Eng tejamkor variant</p>
    </div>

    <div class="cta">
      <button onclick="goToPayment()">To‚Äòlovga o‚Äòtish</button>
    </div>

  </div>

  <div class="hint">
    Xavfsiz ‚Ä¢ Qo‚Äòlda tekshiriladi ‚Ä¢ Telegram qoidalariga mos
  </div>

</div>

<!-- ================= PAGE 2: PAYMENT ================= -->
<div id="page-payment" class="hidden">

  <button class="back-btn" onclick="goBackToTariffs()">
    ‚Üê Tariflarni o‚Äòzgartirish
  </button>

  <div class="icon-circle">
    <!-- WALLET SVG -->
    <svg width="26" height="26" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="1.8"
      stroke-linecap="round" stroke-linejoin="round">
      <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/>
      <path d="M16 3h5v5"/>
      <path d="M16 8l5-5"/>
    </svg>
  </div>

  <h1 align="center">To‚Äòlovni yakunlash</h1>
  <p align="center" id="payText"></p>

  <div class="card">

    <div class="card-number">
      8600 **** **** ****
    </div>

    <button class="copy-btn" onclick="copyCard()">
      Karta raqamini nusxalash
    </button>

    <div class="cta">
      <button onclick="sendReceipt()">Chekni yuborish</button>
    </div>

    <div class="hint">
      Chekni <b>@Haydovchiadminbot</b> botiga yuboring.<br>
      Admin tasdiqlagach Premium faollashadi.
    </div>

  </div>

</div>

</div>

<script>
const tg = window.Telegram.WebApp;
tg.ready();

let selected = { months: 6, price: 170000 };

function selectTariff(months, price) {
  selected = { months, price };
  document.querySelectorAll(".tariff").forEach(t => t.classList.remove("active"));
  event.currentTarget.classList.add("active");
}

function goToPayment() {
  document.getElementById("page-tariffs").classList.add("hidden");
  document.getElementById("page-payment").classList.remove("hidden");

  document.getElementById("payText").innerText =
    `Tarif: ${selected.months} oy ‚Ä¢ ${selected.price.toLocaleString()} so‚Äòm`;
}

function goBackToTariffs() {
  document.getElementById("page-payment").classList.add("hidden");
  document.getElementById("page-tariffs").classList.remove("hidden");
}

function copyCard() {
  navigator.clipboard.writeText("9860260107680035");
  tg.showPopup({ message: "Karta raqami nusxalandi" });
}

async function sendReceipt() {
  const user = tg.initDataUnsafe.user;

  await fetch("/api/payment/init", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      user_id: user.id,
      months: selected.months,
      amount: selected.price
    })
  });

  tg.openTelegramLink("https://t.me/Haydovchiadminbot");
}

  
/* üî• Telegram theme o‚Äòzgarsa ‚Äî avtomatik moslash */
tg.onEvent("themeChanged", () => {
  // Telegram theme ranglarini qayta o‚Äòqiymiz
  document.documentElement.style.setProperty(
    "--bg",
    "var(--tg-theme-bg-color)"
  );
  document.documentElement.style.setProperty(
    "--card",
    "var(--tg-theme-secondary-bg-color)"
  );
  document.documentElement.style.setProperty(
    "--text",
    "var(--tg-theme-text-color)"
  );
  document.documentElement.style.setProperty(
    "--muted",
    "var(--tg-theme-hint-color)"
  );
});

  
</script>

</body>
</html>
