<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Taxi eâ€™lon</title>

<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script src="miniapp_data.js"></script>
<script defer src="miniapp_ai_v2.js"></script>

<style>
body{
  margin:0;
  background:#0f172a;
  color:#f8fafc;
  font-family:system-ui,-apple-system;
}
.container{max-width:520px;margin:auto;padding:16px}
h2{text-align:center;margin-bottom:18px}

.block{margin-bottom:20px}
.label{font-size:15px;font-weight:600;margin-bottom:6px}

input,select,textarea{
  width:100%;
  padding:14px;
  font-size:16px;
  border-radius:12px;
  border:none;
  background:#020617;
  color:#fff;
}

textarea{min-height:90px}
.row{display:flex;gap:10px;flex-wrap:wrap}

.choice{
  flex:1;
  padding:14px;
  text-align:center;
  border-radius:12px;
  background:#020617;
  cursor:pointer;
  font-weight:600;
}
.choice.active{background:#22c55e;color:#052e16}

.toggles{
  display:flex;
  gap:8px;
  flex-wrap:wrap;
}
.toggle{
  padding:12px 16px;
  border-radius:999px;
  background:#020617;
  cursor:pointer;
  font-size:14px;
  white-space:nowrap;
}
.toggle.active{background:#22c55e;color:#052e16}

button{
  width:100%;
  padding:18px;
  border:none;
  border-radius:14px;
  background:#22c55e;
  color:#052e16;
  font-size:18px;
  font-weight:700;
}
.small{
  padding:12px;
  font-size:15px;
}
.hidden{display:none}
</style>
</head>

<body>
<div class="container">

<h2>ðŸš• Taxi eâ€™lon yaratish</h2>

<!-- YOâ€˜NALISH -->
<div class="block">
  <div class="label">Yoâ€˜nalish</div>
  <div class="row">
    <select id="from_region"></select>
    <select id="to_region"></select>
  </div>
</div>

<!-- TUMAN -->
<div class="block">
  <div class="label">Tumanlar</div>
  <div id="districts"></div>
  <button class="small" onclick="addDistrict()">âž• Tuman qoâ€˜shish</button>
</div>

<!-- ODAMLAR -->
<div class="block">
  <div class="label">Necha kishi bor</div>
  <div class="row">
    <div class="choice" data-p="1">1</div>
    <div class="choice" data-p="2">2</div>
    <div class="choice" data-p="3">3</div>
    <div class="choice" data-p="4">4</div>
  </div>
  <input id="people" type="hidden">
</div>

<!-- HOLATLAR -->
<div class="block">
  <div class="label">Holatlar</div>
  <div class="toggles">
    <div class="toggle" data-key="front_seat">ðŸª‘ Old oâ€˜rindiq boâ€˜sh</div>
    <div class="toggle" data-key="has_woman">ðŸ‘© Ayol bor</div>
    <div class="toggle" data-key="urgent">âš¡ Tezkor</div>
    <div class="toggle" data-key="baggage">ðŸ§³ Bagaj</div>
    <div class="toggle" data-key="mail">ðŸ“¦ Pochta</div>
    <div class="toggle" data-key="telegram">ðŸ’¬ Telegram</div>
  </div>
</div>

<!-- VAQT -->
<div class="block">
  <div class="label">Ketish vaqti</div>
  <select id="time"></select>
</div>

<!-- MASHINA -->
<div class="block">
  <div class="label">Mashina rusumi</div>
  <select id="car"></select>
  <input id="custom_car" class="hidden" placeholder="Mashina nomini yozing" style="margin-top:8px">
</div>

<!-- YOQILGâ€˜I -->
<div class="block">
  <div class="label">Yoqilgâ€˜i turi</div>
  <select id="fuel">
    <option>Benzin</option>
    <option>Propan</option>
    <option>Metan</option>
    <option>Elektromobil</option>
  </select>
</div>

<!-- TELEFON -->
<div class="block">
  <div class="label">Telefon raqam</div>
  <input id="phone" value="+998 " placeholder="+998 (__) ___ __ __">
  <input id="phone2" type="hidden">
  <button class="small" onclick="fillMyPhone()">ðŸ“² Mening raqamim</button>
</div>

<!-- IZOH -->
<div class="block">
  <div class="label">Qoâ€˜shimcha izoh</div>
  <textarea id="comment" placeholder="Masalan: ertalab chiqaman, kelishiladi"></textarea>
</div>

<button onclick="submitForm()">ðŸš€ Eâ€™lon yaratish</button>

</div>

<script>
Telegram.WebApp.ready();

/* Odamlar */
document.querySelectorAll("[data-p]").forEach(b=>{
  b.onclick=()=>{
    document.getElementById("people").value=b.dataset.p;
    document.querySelectorAll("[data-p]").forEach(x=>x.classList.remove("active"));
    b.classList.add("active");
  };
});

/* Toggle */
document.querySelectorAll(".toggle").forEach(t=>{
  t.onclick=()=>t.classList.toggle("active");
});

/* Vaqtlar (24 soat, 30 daqiqa) */
const timeSelect = document.getElementById("time");
for(let h=0;h<24;h++){
  for(let m of ["00","30"]){
    const hh=String(h).padStart(2,"0");
    const opt=document.createElement("option");
    opt.value=`${hh}:${m}`;
    opt.textContent=`${hh}:${m}`;
    timeSelect.appendChild(opt);
  }
}

/* Telefon */
function fillMyPhone(){
  const p = Telegram.WebApp.initDataUnsafe?.user?.phone_number;
  if(p) document.getElementById("phone").value = "+998 " + p.slice(-9);
}
</script>

</body>
</html>
